---
title:概述
---

# 消息中间件概述

常用MQ实现：

* RocketMQ
* Kafka
* RabbitMQ



对比维度：

| 功能项      | 功能说明                                                                  | Kafka                             | RocketMQ                                                 | RabbitMQ | Redis |
|----------|-----------------------------------------------------------------------|-----------------------------------|----------------------------------------------------------|----------|-------|
| 吞吐量      | 每秒处理多少条消息                                                             | 每秒几十万                             | 每秒几十万                                                    | 每秒几万     |       |
| 发布订阅的实现  |                                                                       | 消费者直接到日志文件中获得消息                   | 为每个消费者维护一个队列，广播时复制消息到这些队列里                               |          |       |
| 消费结果     | 消费完后如何对消息进行处理。                                                        | 消费成功：消息仍记录在日志文件中<br />消费失败：不会重新入队 | 消费成功：消费完即删除<br />消费失败：同步消息消费失败，重新入队；异步消息消费失败，重试；         |          |       |
| 消息匹配     | 可以为消息自定义分配规则，根据规则选择不同的消息队列。                                           | 不支持                               | 支持，通过routing_key或者自定义消息头，然后通过特殊的Exchange实现               |          |       |
| 优先级队列    | 消息分优先级。优先级高的消息会先被消费，即使是后入队。                                           | 不支持                               | 支持，优先级大小建议设置在0~10之间                                      |          |       |
| 延迟队列     | 等待指定时间后，才把消息放到消息队列中。                                                  | 不支持                               | 支持，可通过设置消息的TTL字段实现。                                      |          |       |
| 死信队列     | 死信：<br />1.队列达到最大长度<br />2.消息被拒绝<br />3.消息过期<br />满足任一条件，消息便会被放到死信队列。 | 不支持                               | 支持。Topic为%DLC%+ConsumerGroup名称                           |          |       |
| 重试队列     |                                                                       | 不支持                               | 支持。Topic为%RETRY%+ConsumerGroup名称                         |          |       |
| 消费模式     | 推模式：Broker将消息推给Consumer or 拉模式：Consumer向Broker获取消息                    | 拉模式                               | 拉模式                                                      | 都支持      |       |
| 广播消费     |                                                                       | 支持，且相对正统                          | 支持，但力度较弱                                                 |          |       |
| 消息回溯     |                                                                       | 支持两种维度的消息回溯：offset和timestamp      | 不支持，只要被确认消费就会被标记删除                                       |          |       |
| 消息堆积     |                                                                       | 支持                                | 支持，但kafka堆积效率要更高                                         |          |       |
| 持久化      |                                                                       | 支持                                | 支持                                                       |          |       |
| 消息追踪     |                                                                       | 不支持                               | 支持，需要配合Firehose                                          |          |       |
| 消息过滤     |                                                                       | 客户端级别的支持                          | 不支持，但可以通过二次封装                                            |          |       |
| 多租户      |                                                                       | 不支持                               | 支持                                                       |          |       |
| 多协议      |                                                                       |                                   | 本身就是AMQP的实现，即支持MQTT、STOMP等协议                             |          |       |
| 跨语言      |                                                                       | 由Scala+Java实现，支持多语言的客户端           | 由Erlang实现，支持多语言客户端                                       |          |       |
| 流量控制     |                                                                       | 支持client级别和user级别，流控可作用于生产者和消费者   | 基于credit-based算法，作用于生产者                                  |          |       |
| 消息顺序性    |                                                                       | 支持单分区级别的顺序性                       | 支持，但条件比较苛刻。需要单线程发送、单线程消费，且不采用延迟队列、优先队列等高级功能。（某种意义来说，不支持） |          |       |
| 安全机制     |                                                                       | 支持身份认证、权限控制                       | 与kafka相似                                                 |          |       |
| 幂等性      |                                                                       | 支持单个生产者单分区会话的幂等性                  | 不支持                                                      |          |       |
| 事务性      |                                                                       | 支持                                | 支持                                                       |          |       |

